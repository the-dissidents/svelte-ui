@forward './parameters' show configure
@use './parameters' as *
@use 'sass:list'
@use 'sass:math'

// #region GERNERIC

%reset
  text-decoration: none
  font-family: cfg(ui-font-family)
  font-size: cfg(input-font-size)
  margin: 0
  padding: 0
  overflow: hidden
  user-select: none
  -webkit-user-select: none
  -moz-user-select: none
  -ms-user-select: none

%disabled-colors
  box-shadow: none

  @include light()
    color: cfg(disabled-text-light)
    background-color: cfg(disabled-back-light)
  @include dark()
    color: cfg(disabled-text-dark)
    background-color: cfg(disabled-back-dark)

:root
  font-family: cfg(ui-font-family)
  line-height: 1.5rem

  text-rendering: optimizeLegibility
  -webkit-font-smoothing: antialiased
  -moz-osx-font-smoothing: grayscale
  -webkit-text-size-adjust: 100%

  scrollbar-color: gray transparent

  @include light()
    color: cfg(text-light)
    background-color: cfg(page-background-light)

  @include dark()
    color: cfg(text-dark)
    background-color: cfg(page-background-dark)

%separator
  @include light()
    border-bottom: cfge(1px solid, separator-light)
  @include dark()
    border-bottom: cfge(1px solid, separator-dark)

%item-separator
  &:not(:last-child)
    @include light()
      border-bottom: cfge(1px solid, separator-minor-light)
    @include dark()
      border-bottom: cfge(1px solid, separator-minor-dark)

%box-focus
  &:focus,
  &:has(:focus)
    @include light()
      border: cfge(1px solid, accent1-border-light)
      outline: cfge(2px solid, accent1-back-light)
    @include dark()
      border: cfge(1px solid, accent1-border-dark)
      outline: cfge(2px solid, accent1-back-dark)

%box
  @extend %reset

  appearance: none

  border-radius: cfg(border-radius-small)
  padding: 3px 5px
  margin: 1px

  line-height: 1.3em
  text-align: start

  &:disabled
    @extend %disabled-colors

  @include light()
    border: cfge(1px solid, box-border-light)
    background-color: cfg(box-back-light)
    color: cfg(text-light)

  @include dark()
    border: cfge(1px solid, box-border-dark)
    background-color: cfg(box-back-dark)
    color: cfg(text-dark)

.lucide
  display: block
  width: 1lh
  height: 1lh
  margin: auto
  stroke: currentColor
  stroke-width: 1
  stroke-linecap: round
  stroke-linejoin: round
  fill: none

// Miscellaneous

h5
  @extend %reset, %separator

  margin: 0 1px 3px 1px
  padding-top: 6px
  font-size: cfg(text-font-size)
  font-weight: bold
  text-transform: uppercase
  text-align: start

  @include light()
    color: cfg(h5-text-light)
  @include dark()
    color: cfg(h5-text-dark)

hr
  @extend %reset, %separator

  border-top: none
  border-left: none
  border-right: none

input
  @extend %reset

label
  @extend %reset
  font-size: cfg(text-font-size)
  line-height: normal

fieldset
  @extend %reset
  border: none
  padding: 0

// #endregion

// #region Buttons

%button-colors
  border: none

  &:focus,
  &:has(:focus)
    @include light()
      outline: cfge(2px solid, accent1-back-light)
    @include dark()
      outline: cfge(2px solid, accent1-back-dark)

  @include light()
    background-color: cfg(button-back-light)
    color: cfg(text-light)
    box-shadow: cfge(0 1px 3px, shadow-light)

  @include dark()
    background-color: cfg(button-back-dark)
    color: cfg(text-dark)
    box-shadow: cfge(0 1px 3px, shadow-dark)

%button
  @extend %box, %button-colors
  @include hover-indicator

  appearance: none
  display: inline-block

  text-align: center
  line-height: normal

  &.noborder
    box-shadow: none
    &:not(:disabled):not(:hover)
      background-color: transparent

  &.left
    border-radius: cfg(border-radius-large) 0 0 cfg(border-radius-large)
    margin-right: 0
    text-align: right
  &.middle
    border-left: none
    border-radius: 0
    margin-inline: 0
  &.right
    border-left: none
    border-radius: 0 cfg(border-radius-large) cfg(border-radius-large) 0
    margin-left: 0
    text-align: left

%button-disabled
  box-shadow: none

  @include light()
    color: cfg(disabled-text-light)
    background-color: cfg(button-disabled-light)
    filter: none
  @include dark()
    color: cfg(disabled-text-dark)
    background-color: cfg(button-disabled-dark)
    filter: none

button:where(:not([data-select-trigger]))
  @extend %button

  &:disabled
    @extend %button-disabled

input[type=number],
input[type=text]
  @extend %box, %box-focus
  padding: 2px 3px

textarea,
div.ProseMirror
  @extend %box, %box-focus

// #endregion

// #region Select

%select
  @extend %box, %box-focus

%select-trigger
  background-image: url("data:image/svg+xml;charset=utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' height='10px' width='15px'><text x='0' y='10' fill='gray'>â–¾</text></svg>")
  background-repeat: no-repeat
  background-position: right 0 center
  background-size: 12px

%select-content
  overflow-y: scroll

  @include light()
    border: cfge(1px solid, box-border-light)
    background-color: cfg(box-back-light)
    color: cfg(text-light)
  @include dark()
    border: cfge(1px solid, box-border-dark)
    background-color: cfg(box-back-dark)
    color: cfg(text-dark)

%select-item
  border-radius: 0
  border-top: none
  padding: 3px 5px
  margin: 0
  min-width: 5em

  text-align: start
  font-family: cfg(ui-font-family)
  font-size: cfg(text-font-size)

  box-shadow: none

  &[data-highlighted]
    filter: brightness(97%)

  @extend %item-separator

select:not([multiple])
  @extend %select-trigger
  @extend %select
  padding: 2px 17px 2px 5px

[data-select-trigger]
  @extend %select-trigger
  padding: 2px 17px 2px 5px

  border: none
  box-shadow: none

  &::before
    content: "\200b"
    display: inline-block
    width: 0

[data-select-content]
  @extend %select-content

  max-height: min(30vh, var(--bits-select-content-available-height))
  width: max(30em, var(--bits-select-anchor-width))
  translate: calc(50% - var(--bits-select-anchor-width) / 2) 0

[data-select-item]
  @extend %select-item

// #endregion

// #region Combobox

%combobox
  @extend %select
  padding: 0
  display: flex
  flex-direction: row

div.combobox
  @extend %combobox

  & [data-combobox-input]
    @extend %box, %box-focus

    padding: 2px 5px 2px 5px
    flex-grow: 1
    border-radius: 2px 0 0 2px
    border: none
    outline: none

  & [data-combobox-trigger]
    @extend %select-trigger
    border: none
    box-shadow: none

    border-radius: 0 2px 2px 0
    padding: 0
    width: 15px

[data-combobox-content]
  @extend %select-content

  max-height: min(30vh, var(--bits-combobox-content-available-height))
  width: max(30em, var(--bits-combobox-anchor-width))
  translate: calc(50% - var(--bits-combobox-anchor-width) / 2) 0

[data-combobox-item]
  @extend %select-item

// #endregion

// #region Radio box & Checkbox

%smallbox
  @extend %reset, %box-focus
  @include hover-indicator

  display: inline-block
  vertical-align: sub

  appearance: none
  height: 0.85rem
  aspect-ratio: 1 / 1
  margin: 3px 2px

  &:disabled
    @extend %disabled-colors

  @include light()
    border: cfge(1px solid, small-border-light)
    background-color: cfg(box-back-light)
    &:not(:disabled):checked
      border: cfge(1px solid, accent2-border-light)
      background-color: cfg(accent2-back-light)
  @include dark()
    border: cfge(1px solid, small-border-dark)
    background-color: cfg(box-back-dark)
    &:not(:disabled):checked
      border: cfge(1px solid, accent2-border-dark)
      background-color: cfg(accent2-back-dark)

input[type=radio]
  @extend %smallbox
  border-radius: 99em

  &:checked
    background-image: url("data:image/svg+xml;charset=utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' height='10px' width='10px' fill='white'><circle cx='5' cy='5' r='5'/></svg>")
    background-repeat: no-repeat
    background-position: center
    background-size: 0.3rem
  &:disabled:checked
    background-image: url("data:image/svg+xml;charset=utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' height='10px' width='10px' fill='gray'><circle cx='5' cy='5' r='5'/></svg>")

// Checkbox

input[type=checkbox]
  @extend %smallbox
  border-radius: 2px

  &:checked
    background-image: url("data:image/svg+xml;charset=utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' height='10px' width='10px' stroke='white' fill='none' stroke-width='1.5px'><path d='M2 6 L5 8 L8 2'/></svg>")
    background-repeat: no-repeat
    background-position: center
    background-size: 0.7rem
  &:disabled:checked
    background-image: url("data:image/svg+xml;charset=utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' height='10px' width='10px' stroke='gray' fill='none' stroke-width='1.5px'><path d='M2 6 L5 8 L8 2'/></svg>")

input[type=checkbox].button
  display: none
  width: 0
  height: 0

label:has(input[type='checkbox'].button)
  @extend %button

  &:has(:disabled)
    @extend %button-disabled

  &:has(:checked)
    @include light()
      background-color: cfg(accent1-back-light)
    @include dark()
      background-color: cfg(accent1-back-dark)

// #endregion

// #region Slider

input[type=range]
  appearance: none
  -webkit-appearance: none
  width: 100%
  background: transparent

  $track-height: 8px
  $thumb-height: 14px

  &::-webkit-slider-thumb
    @extend %button-colors
    @include hover-indicator

    -webkit-appearance: none
    margin-top: math.div($track-height - $thumb-height, 2)
    height: $thumb-height
    width: 16px
    border-radius: cfg(border-radius-small)

  &::-webkit-slider-runnable-track
    width: 100%
    height: $track-height
    border-radius: cfg(border-radius-large)

    @include light()
      background: cfg(slider-track-light)
    @include dark()
      background: cfg(slider-track-dark)

// #endregion

// #region List box

*[role='listbox']
  @extend %box

  display: flex
  flex-direction: column
  white-space: normal
  overflow-y: auto

  padding: 3px 0
  margin: 1px
  border-radius: 3px
  list-style: none

  & > li, [role='listitem']
    font-family: cfg(ui-font-family)
    font-size: cfg(text-font-size)
    line-height: 1.3
    padding: 3px 6px

    &:not(.header)
      @extend %item-separator

    &.header
      font-weight: bold
      @extend %separator

// #endregion
